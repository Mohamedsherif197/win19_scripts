$downloadUrl = "https://go.microsoft.com/fwlink/?linkid=2109047&Channel=Stable&language=en&brand=M100"
$installerPath = "$env:TEMP\edge-x64.exe"

# Download 7-ZIP installer
Invoke-WebRequest -Uri $downloadUrl -OutFile $installerPath

# Install 7-ZIP
Start-Process -FilePath $installerPath -ArgumentList "/quiet", "/norestart" -Wait

# Add a delay to allow time for the installation to complete
Start-Sleep -Seconds 60
# Clean up the installer file
Remove-Item $installerPath
=====================================
$installerUrl = "https://go.microsoft.com/fwlink/?linkid=2109047&Channel=Stable&language=en&brand=M100"
$installerPath = "$env:USERPROFILE\Downloads\MicrosoftEdgeSetup.exe"

try {
    # Download the Microsoft Edge installer
    Invoke-WebRequest -Uri $installerUrl -OutFile $installerPath

    # Start the installation process
    $process = Start-Process -FilePath $installerPath -ArgumentList "/S" -PassThru -Wait

    # Check the exit code to determine if the installation was successful
    if ($process.ExitCode -eq 0) {
        Write-Host "Installation completed successfully."
    } else {
        Write-Host "Installation failed with exit code $($process.ExitCode)."
    }
}
catch {
    Write-Host "An error occurred during the installation: $_"
}
finally {
    # Clean up the installer file
    Remove-Item -Path $installerPath -Force
}

==================================================================================================

md -Path $env:temp\edgeinstall -erroraction SilentlyContinue | Out-Null
$Download = join-path $env:temp\edgeinstall MicrosoftEdgeEnterpriseX64.msi

Invoke-WebRequest 'https://msedge.sf.dl.delivery.mp.microsoft.com/filestreamingservice/files/a2662b5b-97d0-4312-8946-598355851b3b/MicrosoftEdgeEnterpriseX64.msi'  -OutFile $Download

Start-Process "$Download" -ArgumentList "/quiet /passive"

Start-Process "$Download" -ArgumentList "/quiet"

md -Path $env:temp\edgeinstall -erroraction SilentlyContinue | Out-Null
$Download = join-path $env:temp\edgeinstall MicrosoftEdgeEnterpriseX64.msi
Invoke-WebRequest 'https://go.microsoft.com/fwlink/?linkid=2109047&Channel=Stable&language=en&brand=M100'  -OutFile $Download
Start-Process "$Download" -ArgumentList "/quiet"

md -Path $env:temp\edgeinstall -erroraction SilentlyContinue | Out-Null
$Download = join-path $env:temp\edgeinstall MicrosoftEdgeEnterpriseX64.msi
(new-object System.Net.WebClient).DownloadFile('https://msedge.sf.dl.delivery.mp.microsoft.com/filestreamingservice/files/a2662b5b-97d0-4312-8946-598355851b3b/MicrosoftEdgeEnterpriseX64.msi',$Download)
Start-Process "$Download" -ArgumentList "/quiet"

$INSTALLED = Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* |  Select-Object DisplayName, DisplayVersion, Publisher, InstallDate
$INSTALLED += Get-ItemProperty HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate
$INSTALLED | ?{ $_.DisplayName -match 'edge' } | sort-object -Property DisplayName -Unique | Format-Table -AutoSize
