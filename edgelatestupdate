$edgeExecutablePath = (Get-Item "C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe").FullName

if ($edgeExecutablePath) {
    Write-Output "Microsoft Edge is installed."
    $edgeVersionInfo = Get-FileVersionInfo -Path $edgeExecutablePath
    $edgeVersion = $edgeVersionInfo.ProductVersion

    if ($edgeVersion) {
        Write-Output "Installed version: $edgeVersion"

        $targetVersion = [Version]"119.0.2151.97"
        $currentVersion = [Version]$edgeVersion

        if ($currentVersion -lt $targetVersion) {
            Write-Output "Current version is older than the target version. Updating..."

            $installerUrl = "https://go.microsoft.com/fwlink/?linkid=2109047&Channel=Stable&language=en&brand=M100"
            $installerPath = "$env:USERPROFILE\Downloads\MicrosoftEdgeSetup.exe"

            # Download the installer
            Invoke-WebRequest -Uri $installerUrl -OutFile $installerPath

            # Start the installation process
            Start-Process -FilePath $installerPath -ArgumentList "/silent" -Wait

            # Check the exit code to determine if the installation was successful
            if ($LastExitCode -eq 0) {
                Write-Output "Installation completed successfully."
            } else {
                Write-Output "Installation failed with exit code $LastExitCode."
            }
        } else {
            Write-Output "Microsoft Edge is up to date."
        }
    } else {
        Write-Output "Unable to retrieve Edge version."
    }
} else {
    Write-Output "Microsoft Edge is not installed."
}
